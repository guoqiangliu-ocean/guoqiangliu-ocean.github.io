<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guoqiang Liu - Physical Oceanographer</title>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        :root {
            --gold: #FFD700;
            --cyan: #7fdbff;
            --bg-dark: #050f1a;
            --glass: rgba(10, 20, 30, 0.6);
        }

        * { box-sizing: border-box; }

        html, body {
            margin: 0; padding: 0;
            font-family: "Inter", sans-serif;
            background-color: var(--bg-dark);
            color: #fff;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* 背景层级 */
        #bg-video {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -10; object-fit: cover;
            filter: brightness(0.4) contrast(1.1);
        }

        .video-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -9;
            background: radial-gradient(circle at center, rgba(5,15,26,0.1) 0%, rgba(5,15,26,0.8) 100%);
        }

        #spray-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -8; pointer-events: none;
        }

        /* 顶部导航 - 使用 Flex 布局 */
        .topnav {
            position: fixed; top: 0; width: 100%; height: 80px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 5%; z-index: 100;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .brand { 
            font-family: "Playfair Display", serif; font-weight: 700; font-size: 1.5rem; 
            letter-spacing: 2px; color: #fff; text-decoration: none;
        }

        .nav-links { display: flex; gap: 30px; }
        .nav-links a {
            color: rgba(255,255,255,0.7); text-decoration: none;
            font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1.5px;
            transition: 0.3s;
        }
        .nav-links a:hover { color: var(--cyan); }

        /* 核心展示区 - 使用 Flex 居中 */
        .hero-section {
            height: 100vh;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            padding: 0 20px;
            text-align: center;
        }

        .name-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 60px 50px; border-radius: 8px;
            max-width: 900px; width: 100%;
            box-shadow: 0 40px 100px rgba(0,0,0,0.5);
            animation: fadeUp 1.5s cubic-bezier(0.2, 1, 0.3, 1);
        }

        .name-card h1 {
            font-family: "Playfair Display", serif;
            font-size: clamp(2.5rem, 10vw, 5.5rem);
            margin: 0; letter-spacing: -2px; line-height: 1;
        }

        .subtitle {
            font-size: 1.2rem; color: var(--cyan); margin-top: 20px;
            letter-spacing: 5px; text-transform: uppercase; font-weight: 300;
        }

        .counter-box {
            margin-top: 40px; font-size: 0.75rem; color: rgba(255,255,255,0.4);
            letter-spacing: 1px;
        }

        /* 抽屉层 - 科学致敬 */
        .giants-drawer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #03080e; z-index: 200;
            transform: translateY(100%); transition: transform 0.8s cubic-bezier(0.7, 0, 0.3, 1);
            overflow-y: auto;
        }
        .giants-drawer.open { transform: translateY(0); }

        .drawer-container {
            max-width: 1200px; margin: 0 auto; padding: 100px 40px;
            display: flex; flex-direction: column; align-items: center;
        }

        #visitor-map {
            width: 100%; height: 400px; border-radius: 8px;
            border: 1px solid rgba(255, 215, 0, 0.2); margin-bottom: 20px;
        }

        /* 科学家网格 - 使用 Grid 布局 */
        .scientists-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 40px; width: 100%; margin-top: 60px;
        }

        .scientist-item {
            padding: 30px; border-bottom: 1px solid rgba(255,255,255,0.05);
            transition: 0.4s;
        }
        .scientist-item:hover { background: rgba(255,255,255,0.03); }
        .scientist-item .name { font-family: "Playfair Display"; font-size: 1.8rem; color: var(--gold); }
        .scientist-item .contribution { font-size: 0.9rem; color: rgba(255,255,255,0.6); margin-top: 10px; line-height: 1.6; }

        /* 交互按钮 */
        .legacy-trigger {
            position: fixed; bottom: 40px; right: 40px; z-index: 150;
        }
        .legacy-btn {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2); color: #fff;
            padding: 15px 30px; border-radius: 50px; cursor: pointer;
            font-family: "Playfair Display"; transition: 0.3s;
        }
        .legacy-btn:hover { background: #fff; color: #000; transform: translateY(-5px); }

        .close-drawer {
            position: absolute; top: 40px; right: 40px; font-size: 2.5rem;
            background: none; border: none; color: #fff; cursor: pointer; opacity: 0.5;
        }

        /* 脉冲动画 */
        .pulse-icon { background: var(--gold); border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        @keyframes fadeUp { from {opacity:0; transform: translateY(40px);} to {opacity:1; transform: translateY(0);} }
    </style>
</head>
<body>

<video autoplay muted loop playsinline id="bg-video">
    <source src="https://videos.pexels.com/video-files/855018/855018-hd_1920_1080_30fps.mp4" type="video/mp4">
</video>
<div class="video-overlay"></div>
<canvas id="spray-canvas"></canvas>

<nav class="topnav">
    <a href="#" class="brand">G. LIU</a>
    <div class="nav-links">
        <a href="#research">Research</a>
        <a href="#publications">Publications</a>
        <a href="#cv">Curriculum Vitae</a>
    </div>
</nav>

<main class="hero-section">
    <div class="name-card">
        <h1>Guoqiang Liu</h1>
        <div class="subtitle">Physical Oceanographer</div>
        <div class="counter-box">
            <span id="visitor-ip">CONNECTING TO SENSORS...</span> 
            <span style="margin: 0 15px; opacity: 0.2;">|</span>
            STATION ACCESS: <span id="busuanzi_value_site_pv" style="color: var(--gold);">..</span>
        </div>
    </div>
</main>

<div class="legacy-trigger">
    <button class="legacy-btn" onclick="toggleDrawer()">Standing on the Shoulders of Giants</button>
</div>

<div class="giants-drawer" id="giantsDrawer">
    <button class="close-drawer" onclick="toggleDrawer()">×</button>
    <div class="drawer-container">
        <h2 style="font-family: 'Playfair Display'; font-size: 2.5rem; margin-bottom: 40px;">Global Node & Scientific Legacy</h2>
        
        <div id="visitor-map"></div>
        <p id="map-status" style="color: var(--cyan); letter-spacing: 2px; font-size: 0.7rem;">PINGING GLOBAL RESEARCH NETWORK...</p>

        <div class="scientists-grid">
            <div class="scientist-item">
                <div class="name">Walter Munk</div>
                <div class="contribution">The "Einstein of the Oceans." Pioneered ocean acoustics and wave propagation theory.</div>
            </div>
            <div class="scientist-item">
                <div class="name">Andrey Kolmogorov</div>
                <div class="contribution">Established the -5/3 power law for turbulence, fundamental to understanding ocean mixing.</div>
            </div>
            <div class="scientist-item">
                <div class="name">Harald Sverdrup</div>
                <div class="contribution">Defined the Sverdrup Balance, explaining wind-driven ocean circulation.</div>
            </div>
            <div class="scientist-item">
                <div class="name">Henry Stommel</div>
                <div class="contribution">Revolutionized oceanography by explaining the intensification of Western Boundary Currents.</div>
            </div>
        </div>
    </div>
</div>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script>
    let map;

    // 1. 抽屉开关逻辑
    function toggleDrawer() {
        const drawer = document.getElementById('giantsDrawer');
        drawer.classList.toggle('open');
        if (drawer.classList.contains('open')) {
            setTimeout(() => {
                if (!map) initMap();
                else map.invalidateSize();
            }, 800);
        }
    }

    // 2. IP 追踪与地图初始化
    async function initMap() {
        try {
            const res = await fetch('https://ipapi.co/json/');
            const data = await res.json();
            const { latitude, longitude, city, ip } = data;

            document.getElementById('visitor-ip').innerText = `NODE: ${city.toUpperCase()} [${ip}]`;
            document.getElementById('map-status').innerText = `LAST PING: ${city} NODE ACTIVE`;

            map = L.map('visitor-map', { center: [20, 0], zoom: 2, zoomControl: false, attributionControl: false });
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

            const pulseIcon = L.divIcon({ className: 'pulse-icon', iconSize: [12, 12] });
            L.marker([latitude, longitude], { icon: pulseIcon }).addTo(map).bindPopup(city).openPopup();
            
            map.flyTo([latitude, longitude], 4);
        } catch (e) {
            console.log("Map failed to load.");
        }
    }

    // 3. Canvas 飞沫动画
    const canvas = document.getElementById('spray-canvas');
    const ctx = canvas.getContext('2d');
    let w, h, particles = [];

    function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize);
    resize();

    class Particle {
        constructor() { this.init(); }
        init() {
            this.x = Math.random() * w; this.y = Math.random() * h;
            this.vx = (Math.random() - 0.5) * 0.4; this.vy = (Math.random() - 0.5) * 0.2;
            this.size = Math.random() * 1.5; this.alpha = 0; this.life = 0; 
            this.maxLife = 100 + Math.random() * 200;
        }
        update() {
            this.x += this.vx; this.y += this.vy; this.life++;
            if (this.life < 50) this.alpha = this.life / 50 * 0.3;
            else if (this.life > this.maxLife - 50) this.alpha = (this.maxLife - this.life) / 50 * 0.3;
            if (this.life > this.maxLife) this.init();
        }
        draw() {
            ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(200, 240, 255, ${this.alpha})`; ctx.fill();
        }
    }

    for(let i=0; i<100; i++) particles.push(new Particle());
    function animate() {
        ctx.clearRect(0, 0, w, h);
        particles.forEach(p => { p.update(); p.draw(); });
        requestAnimationFrame(animate);
    }
    animate();
    
    // 自动获取一次 IP
    initMap();
</script>

</body>
</html>
